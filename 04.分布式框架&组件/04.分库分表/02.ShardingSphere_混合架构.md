
![[Pasted image 20240105103812.png|600]]

上图中的一些细节：ShardingSphere-JDBC仅支持Java应用程序；ShardingSphere-Proxy没有此限制，而且支持使用MySQL CLI进行连接操作。

>DistSQL分类与语法设计示意图

![[Pasted image 20240105103832.png|600]]

# 1.节点

## 1.1.计算节点

ShardingSphere-JDBC和ShardingSphere-Proxy实例均负责提供计算能力，它们被称为<font color="#f79646">计算节点</font>（Compute Node）。

## 1.2.存储节点与存储单元

物理数据库ds_0，ds_1和ds_2提供数据存储能力，对应的被称为存储节点（Storage Node）。根据存储节点的形态不同，将实例级节点称为<font color="#f79646">Storage Node</font>（比如一个MySQL Instance），库级节点称为<font color="#f79646">Storage Unit</font>（比如一个MySQL Database）。一个Storage Node可以提供多个Storage Unit。

# 2.对象

## 2.1.实例级对象

实例级对象（Instance Object）的<font color="#f79646">作用域是整个计算节点实例</font>，它们的能力影响所有逻辑库中的操作。

### 1.全局规则

全局规则（Global Rules）包含Authority、Transaction、SQL Parser、SQL Translator等在ShardingSphere全局范围内生效的规则配置，它们分别控制了认证和授权、分布式事务、SQL解析、SQL翻译等功能引擎，是计算节点运行时的基础配置。值得一提的是，在<font color="#f79646">ShardingSphere中全局规则均有默认值</font>，用户如无特殊需要，保持默认即可。

### 2.分布式变量

分布式变量（Dist Variables）是ShardingSphere中存在的一组系统级变量，它们的配置同样影响到整个计算节点。取名Dist Variables，是为了方便用户在使用时与存储节点自身的Variables作区分，避免混淆。同时，对分布式变量值的修改会同步到整个计算节点集群，是真正的分布式配置。分布式变量包含：
* SQL_SHOW
* MAX_CONNECTIONS_SIZE_PER_QUERY
* SQL_FEDERATION_TYPE 
等常用的计算节点属性，完整覆盖YAML中的props配置。

### 3.作业

作业（Job）特指Proxy计算节点提供的异步作业的能力，例如为用户提供数据迁移的Migration Job，未来还可能提供更丰富的异步作业功能。

## 2.2.库级对象

库级对象（Database Object）主要用于对逻辑库级别的元数据进行管理，提供REFRESH DATABASE METADATA、EXPORT DATABASE CONFIGURATION等元数据的操作。
## 2.3.表级对象

表级对象（Table Object）是指其作用域为特定逻辑表的对象，可以简单的理解为表级别的规则配置。表级对象包含常用的Broadcast（广播表）、Encrypt（数据加密）、Sharding（数据分片）、Single（单表）等规则，这些规则的名称往往与逻辑表名相同。
## 2.4.关系型对象

关系型对象（Relation Object）不是用于管理某个特定的库或表，它们用于描述某一组对象之间的关联关系。当前关系型对象包含两类：
* 描述存储节点关系的<font color="#f79646">DB_Discovery Rule</font>；
* 描述分片表关系的<font color="#f79646">Sharding Table Reference Rule</font>。

## 2.5.流量型对象

流量型对象（Traffic Object）用于管理ShardingSphere中的数据流量，包含Readwrite-splitting Rule和Shadow Rule这类的流量规则。

