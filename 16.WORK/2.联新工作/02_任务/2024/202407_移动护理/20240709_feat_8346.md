# 1.CR

>Java群

项目：mnis  
内容：8346【湖南省妇幼保健院】批量打印护理文书及表单
分支：feat_release_mnis_v3.8_wpb_8346 into qa_mnis_v3.8
MR：http://10.2.3.111:86/backend_group/backend_application/mnis/merge_requests/5447
# 2.脚本

>邮件

> [!danger] 注意事项
> 提供脚本为实际线上脚本，所以必须考虑实际线上情况
> 1.开关，默认应为关闭（根据实际情况而定）
> 2.IP地址，默认应为127.0.0.1（一般情况）
> 3.如果是修改原有配置，需要考虑平滑过度（不可简单覆盖）

---

宝哥麻烦归档下脚本：

测试环境：10.2.3.170
项目：mnis
服务：mnis
冲刺版本：移动护理迭代48
故事编号：8346
版本号：MNIS V3.8.107
分支：feat_release_mnis_v3.8_wpb_8346

MySQL脚本

```sql
use windranger_mnis;
alter table doc_data_filing_record modify STATUS int default 1 null comment '状态（-3.生成失败 -2.生成PDF进行中 -1.生成PDF完成 0.归档进行中 1.归档已完成 2.归档失败）';
alter table doc_data_filing_record add pdf_url varchar(256) null comment 'PDF路径' after STATUS;
alter table doc_data_filing_record add archive_start_time datetime null comment '归档开始时间' after pdf_url;
alter table doc_data_filing_record add archive_finish_time datetime null comment '归档完成时间' after archive_start_time;
```

> [!danger] 注意事项
> 脚本后不要带 `;` ~

MongDB脚本

```js
use coms
db.sysConfigFile.update({ 'key': 'PaperlessDocFilingSettings' }, { "$pull": { 'children': { 'key': 'paperlessDocLog' } } })
db.sysConfigFile.update({ 'key': 'PaperlessDocFilingSettings' }, {
    "$push": {
        "children":
	 		{
				"_id" : "65095eeccf1fe2309d010bc2-Wed Jul 17 2024 14:54:23 GMT+0800",
				"key" : "paperlessDocLog",
				"pattern" : {
					"componentType" : "Switch",
					"label" : "无纸化归档日志打印"
				},
				"value" : false
			}
    }
})
```

# 3.提测单

>提测群

http://10.2.3.109:1024/zentao/testtask-view-7991.html
8346【湖南省妇幼保健院】-无法批量打印护理文书及表单 --- 已提测
# 4.其它

需要回归测试的文书类型（总共3+4=7种）

* 分娩记录单
* 护理计划
* 体温单
* 非上述情况的普通文书、护理记录、风险评估、Lina文书

需回归测试场景

1. 手动执行仅生成PDF
	1. 正常流程：生成PDF成功
	2. 异常流程：生成PDF失败
2. 手动执行归档
	1. 正常流程：归档成功
	2. 异常流程：归档过程中失败
3. 出院自动归档（流程同上）
4. HIS调用接口执行归档（流程同上）
	1. 170环境接口：http://10.2.3.170:9099/WRMSMnis/doc.html#/API/Doc-Filing/operateDocFilingForHisUsingPOST_2
	2. 参数设置可参考手动执行归档中HTTP请求参数进行模拟测试
	3. 侧重点：验证返回数据结构与之前版本数据结构是否一致