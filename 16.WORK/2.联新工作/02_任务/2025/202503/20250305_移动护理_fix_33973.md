# 1.CR

>Java群

项目：mnis  
内容：33973【清华大学附属北京清华长庚医院】医院提供的执行单接口中没有order_sort_no,导致执行口服药报错
 - MNIS初始化组件日志打印（为了确定执行顺序）
 - 开启新版巡视时病房巡视列表性能优化
 - 去除之前归档错误的脚本
分支：fix_release_mnis_v3.8_wpb_33973 into release_mnis_v3.8
MR：http://10.2.3.111:86/backend_group/backend_application/mnis/merge_requests/6539

项目：emr
分支：fix_release_mnis_v3.8_wpb_33973 into release_mnis_v3.8
MR：http://10.2.3.111:86/backend_group/backend_application/emr/merge_requests/2765

# 2.脚本

>邮件

> [!danger] 注意事项
> 提供脚本为实际线上脚本，所以必须考虑实际线上情况
> 1.开关，默认应为关闭（根据实际情况而定）
> 2.IP地址，默认应为127.0.0.1（一般情况）

---

宝哥麻烦归档下脚本：

测试环境：10.2.3.170
项目：mnis
冲刺版本：
单号：33973
版本号：MNIS V3.8.127
分支：fix_release_mnis_v3.8_wpb_33973

MySQL脚本

```sql
/*  
 * 重新归档 20250210 王鹏博 bug： 33711【广西科技大学第一附属医院】患者跌倒风险评估，存在总分为/的情况，但是数据保存时为-1001  
 */  
use windranger_emr;  
update pat_inhos_nurse_evalution set total_point = null where total_point = -1001;
```


> [!danger] 注意事项
> 脚本后不要带 `;` ~

MongDB脚本

```js
use mnis

function dropIndexIfExists(name) {
    try {
        var indexes = db.patNursePatrolTaskInfo.getIndexes();
        var indexExists = false;
        for (let i = 0; i < indexes.length; i++) {
            if (indexes[i].name === name) {
                indexExists = true;
                break;
            }
        }

        if (indexExists) {
            db.patNursePatrolTaskInfo.dropIndex(name);
            print("索引已成功删除");
        } else {
            print("索引不存在，无需删除");
        }
    } catch (error) {
        print("操作失败");
    }
}

dropIndexIfExists("idx_createTime")
```

# 3.提测单

>提测群

http://10.2.3.109:1024/zentao/testtask-view-9079.html
33973【清华大学附属北京清华长庚医院】医院提供的执行单接口中没有order_sort_no,导致执行口服药报错
 - 开启新版巡视时病房巡视列表性能优化 --- 已提测

# 4.其它





