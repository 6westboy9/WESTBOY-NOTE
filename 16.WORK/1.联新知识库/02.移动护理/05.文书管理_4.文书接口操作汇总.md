# 通用操作

## 添加文书/表头/页

```shell
# POST
http://10.2.3.170:86/api/windranger/doc/nursing/header/doc/batchSave

[
	{
		"inhosCode": "17036524",
		"patCode": "1157002",
		"wardCode": "309",
		"headerTitle": "新表头",
		"reportTypeCode": "evaluateDoc",
		"templateCode": "T001291",
		"templateName": "WPB-血栓评估单"
	}
]  
```


>此接口是一个通用接口，护理记录、护理评估、普通文书和Lina文书删除操作都可能调用此接口~

```json
// POST
// com.lachesis.windranger.doc.service.IDocDataNurseHeaderService#deleteDoc
// inhosCode=16979456
// documentCode=D00309600
// docReportType=D00309600
// http://10.2.3.170:10000/api/windranger/doc/nursing/header/16979456/D00309600/nursingDoc
// /doc/nursing/header/{inhosCode}/{documentCode}/{docReportType}
```

# 护理记录

## 新增表头

```shell
# POST
http://10.2.3.170:10000/api/windranger/doc/nursing/header/header

{
	"inhosCode": "16979456",
	"templateCode": "T111115",
	"documentCode": "D00309600",
	"wardCode": "340",
	"headerTitle": "2024-05-08"
}
```

## 删除表头

```shell
# DELETE
# inhosCode=16979456
# templateCode=T111115
# documentCode=D00309600
# headerCode=H00320028
http://10.2.3.170:10000/api/windranger/doc/nursing/header/16979456/T111115/D00309600/H00320028
```



我是这样想的，护理记录单

- 新增表头 对应日志 创建文书
- 编辑行或者列 对应日志 修改文书
- 删除表头 对应日志 删除文书

## 新增/更新行记录

><font color="#f79646">支持单行和多行新增/更新操作~</font>

```shell
# POST
http://10.2.3.170:10000/api/windranger/doc/nursing/batch

[
	{
		"seqId": 2629842,
		"inhosCode": "16979456",
		"patCode": "1156840",
		"wardCode": "340",
		"headerCode": "H00299940",
		"documentCode": "D00309600",
		"templateCode": "T111115",
		"templateName": "护理记录单",
		"recordCode": "1723983840499863552-2303",
		"recordDate": "2023-11-13T16:37:00.000+0800",
		"inoutCount": null,
		"countType": null,
		"crownSign": null,
		"crownSignTime": null,
		"createPerson": "123",
		"createTime": "2023-11-13T16:39:12.000+0800",
		"rowNum": 0,
		"createPersonName": "李",
		"crownSignName": null,
		"signUserCode": null,
		"recordDetails": [
			{
				"seqId": 20504130,
				"recordCode": "1723983840499863552-2303",
				"inhosCode": "16979456",
				"itemCode": "P00000093",
				"itemName": "日期",
				"customEnumVal": null,
				"recordDate": "2023-11-13T16:37:00.000+0800",
				"structTypeCode": "nurseBase",
				"structTypeName": "护理记录基础项目",
				"structCode": "date",
				"structName": "日期",
				"itemValue": "2023-11-13",
				"createPerson": "123",
				"createTime": "2023-11-13T16:39:12.000+0800",
				"rowValues": null,
				"componentType": null,
				"wardCode": null,
				"patCode": null
			},
			...
			{
				"itemCode": "P00027049",
				"itemName": "下拉单选",
				"itemValue": "分娩",
				"structCode": null,
				"structName": null,
				"structTypeCode": null,
				"structTypeName": null,
				"inhosCode": "16979456",
				"recordCode": "1723983840499863552-2303"
			}
		],
		"docCaSign": {
			"type": "nurseDocData",
			"caIdentityParamsMap": {}
		},
		"bedCode": null,
		"patName": null,
		"firstVisitRecord": false,
		"index": null,
		"pageNo": null,
		"customHeaderDetails": null
	},
	...
]
```

## 删除行记录


```shell
# POST
# seqId=2629942
http://10.2.3.170:10000/api/windranger/doc/nursing/2629942
```


# 护理评估

| 功能     | 接口路径                                                                                     | PC      | PDA |
| ------ | ---------------------------------------------------------------------------------------- | ------- | --- |
| 新增页/换页 | /doc/evaluate/addCutPageHeader                                                           | 文书详情-换页 |     |
| 删除数据   | /doc/evaluate/record/{inhosCode}/{templateCode}/{documentCode}/{headerCode}/{recordCode} |         |     |
|        | /doc/evaluate/record/{inhosCode}/{templateCode}/{documentCode}/{recordCode}              |         |     |


## 新增页/换页

```json
// POST http://10.2.3.172:10000/api/windranger/doc/evaluate/addCutPageHeader

// 请求体
{
    "documentCode": "D00331280",
    "inhosCode": "17135452",
    "patCode": "1023482",
    "reportTypeCode": "evaluateDoc",
    "templateCode": "T001241",
    "templateName": "自理能力评估单",
    "wardCode": "309"
}

// 响应
{
    "code": 1001,
    "msg": "成功",
    "data": {
        "seqId": 188960,
        "wardCode": "309",
        "inhosCode": "17135452",
        "templateCode": "T001241",
        "documentCode": "D00331280",
        "headerCode": "H00319766",
        "headerTitle": "新表头",
        "pageNo": 5,
        "beginDate": null,
        "endDate": null,
        "createPerson": "123",
        "createTime": "2024-05-27T18:08:01.237+0800",
        "updatePerson": null,
        "updateTime": null
    }
}
```

## 删除单页-单条数据记录


```sql
doc_data_evaluate_record
doc_data_evaluate_record_detail
```


```json
// DELETE http://10.2.3.172:10000/api/windranger/doc/evaluate/record/17135452/T001241/D00331280/H00319756/1793574703441514496-27440
// com.lachesis.windranger.controller.doc.DocEvaluateRecordController#deleteRecord
```


## 新增/更新单页-单条数据记录


```json
// POST http://10.2.3.172:10000/api/windranger/doc/evaluate/record
// 核心实现方法：com.lachesis.windranger.doc.service.impl.DocDataEvaluateRecordService#saveEvaluateRecord
{
    "recordCode": "1793574703441514496-27440",
    "rowValue": {
        "P00025826": "2024-05-23",
        "P00025829": "17:27",
        "P00025833": "P00025848",
        "P00025835": "P00025859",
        "P00025838": "P00025851",
        "P00025839": "P00025862",
        "P00025840": "P00025853",
        "P00025841": "P00025854",
        "P00025842": "P00025855",
        "P00025843": "P00025856",
        "P00025844": "P00025857",
        "P00025847": "@txt_123_李",
        "P00025845": "85",
        "P00025846": "01",
        ...
    },
    "showTextValue": {
        "P00025826": "2024-05-23",
        "P00025829": "17:27",
        "P00025833": "完全独立",
        "P00025835": "需部分帮助",
        "P00025837": "",
        "P00025838": "完全独立",
        "P00025839": "需部分帮助",
        "P00025840": "完全独立 ",
        "P00025841": "完全独立 ",
        "P00025842": "完全独立  ",
        "P00025843": "完全独立  ",
        "P00025844": "完全独立  ",
        "P00025847": "@txt_123_李",
        "P00025845": "85",
        "P00025846": "轻度依赖",
        "P00025848": "√",
        "P00025858": "",
        ...
    },
    "taskTime": null,
    "documentCode": "D00331280",
    "headerCode": "H00319756",
    "inhosCode": "17135452",
    "patCode": "1023482",
    "evaluateNature": "selfCare",
    "templateCode": "T001241",
    "templateName": "自理能力评估单",
    "wardCode": "309",
    "recordDate": "2024-05-23T17:27:00.000+0800"
}
```

# 普通文书
## 新增页

>可以看到删除的是单页

```shell
# POST
http://10.2.3.170:86/api/windranger/doc/ordinary/record

{
  "wardCode": "309",
  "templateCode": "T000088",
  "patCode": "9932021",
  "inhosCode": "99548448",
  "templateName": "护理会诊单",
  "detailList": [
    {
      "itemCode": "P00005999",
      "itemName": "病人信息",
      "itemValue": ""
    },
    {
      "itemCode": "P00006000",
      "itemName": "姓名：",
      "itemValue": "莫振华2"
    },
    {
      "itemCode": "P00006001",
      "itemName": "床号：",
      "itemValue": "10203"
    },
    ...
    {
      "itemCode": "P00006025",
      "itemName": "日期：",
      "itemValue": ""
    }
  ],
  "documentCode": "D00331857"
}
```

## 删除页

>可以看到支持删除单页和多页

```shell
# 操作入口1：患者护理文书 - 右击 - 删除
# 操作入口2：患者护理文书 - 文书详情 - 删除
# DELETE
http://10.2.3.170:10000/api/windranger/doc/ordinary/document

{
  "documents": [
    "D00331859"
  ],
  "inhosCode": "124594561",
  "isCheckBeforeDelete": "0",
  "templateCode": "T000088"
}
```

