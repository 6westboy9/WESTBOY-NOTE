
# 架构图

[架构图汇总](http://10.2.3.159:8090/pages/viewpage.action?pageId=91130400)

## 后端服务架构

![[Pasted image 20240605141613.png|650]]

>来源：https://www.processon.com/view/link/632ae597e401fd43463aa6d0


## 思考

* 基础组件
	* 同步程序
		* <font color="#ffc000">数据同步</font>（回写就是其反向操作，业务方需要，直接配置对接即可）→ 核心
			* 推送
			* 拉取
		* <font color="#c0504d">数据回写</font>（等同于同步反向操作，其实可以抽象为同步程序某个任务，只不过是反向而已）
			* 如果只有移动护理一个服务使用，那岂不是应该独立出来，直接对接同步程序的任务即可
		* 互联互通
			* 方案一：MongoDB+MySQL
				* MongDB用作所有软件业务，优先保证MongoDB的性能
				* 互联互通场景另起一个MySQL服务，将外部需要数据，将MongoDB数据同步至MySQL提供视图给外部使用
				* 互联互通，不是所有医院都要上，不必上的医院直接省去了MySQL的资源开销
				* MongoDB天然分布式，无需分库分表（其实细化的话，对于历史数据一般很少访问，需要考虑冷热数据分离设计策略）
			* 方案二：选型一种数据库既可以满足业务，比如PostgreSQL，需调研
		* <font color="#c0504d">数据转抄</font>（同步链路中的一环而已）
		* <font color="#c0504d">数据直查</font>（同步的一种情况而已，即需要满足<font color="#f79646">实时同步</font>和<font color="#f79646">离线同步</font>两种情况）
	* 配置中心
	* 消息中心
	* 运维中心
		* 基础组件管控台（主要目的：收紧入口，方便查找）
			* RPC：Dubbo
			* 消息队列：RabbitMQ/EMQX
			* <font color="#4bacc6">定时任务</font>：XXL
			* <font color="#4bacc6">监控</font>：Prometheus
			* <font color="#4bacc6">日志</font>：Loki
			* 接口文档：Swagger/Knife4j
			* <font color="#4bacc6">文件存储</font>：MinIO
			* <font color="#4bacc6">容器化</font>：Docker/K8s
		* 自研模块

><font color="#4bacc6">蓝色</font>：缺失能力
><font color="#ffc000">黄色</font>：核心能力
><font color="#c0504d">红色</font>：附属能力

# 服务接口文档

| GitLab项目名称            | Maven坐标                          | 接口文档                                              | 项目根路径             | 端口    |                                        |
| --------------------- | -------------------------------- | ------------------------------------------------- | ----------------- | ----- | -------------------------------------- |
| foundation_fastdeploy | windranger-foundation-fastdeploy | http://10.2.3.170:10480/WRMSFoundationFD/doc.html | /WRMSFoundationFD | 10480 | foundation + authentication + hospital |
| foundation            | foundation                       |                                                   | /WRMSFoundation   | 10381 |                                        |
| authentication        | authentication                   |                                                   |                   |       |                                        |
| hospital              | hospital                         | http://10.2.3.170:10480/WRMSFoundationFD/doc.html |                   |       |                                        |
| mnis                  | mnis                             | http://10.2.3.170:9099/WRMSMnis/doc.html          | /WRMSMnis         | 9099  |                                        |
| data_sync             | data-sync                        | http://10.2.3.170:9098/data-sync/doc.html         | /data-sync        | 9098  |                                        |
| emr                   | emr                              | http://10.2.3.170:10383/WRMSEmr/doc.html          | /WRMSEmr          | 10383 |                                        |
# 小工具

呈现形式

* IDEA插件？
* WEB页面？不推荐，数据应该维护在本地
* PC端？推荐

功能

* 切换配置
	* 切换本地项目配置：开发 or 测试
* 配置环境
	* 默认：86 → 禁止修改（可访问、可复制）
		* 设置MNIS服务：10.2.3.170
		* 设置EMR服务：10.2.3.170
	* 自定义1：10000
		* 设置MNIS服务：10.2.43.39
		* 设置EMR服务：10.2.43.39
	* 自定义2：10001
		* 设置MNIS服务：10.2.43.39
		* 设置EMR服务：10.2.3.170


