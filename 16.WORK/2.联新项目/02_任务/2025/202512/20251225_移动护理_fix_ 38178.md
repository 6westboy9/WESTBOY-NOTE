# 1.CR  
  
>Java群  

项目：mnis
内容：38178【广西南宁第二人民医院】-移动护理-文书系统-旧版分娩记录单新增开关
分支：fix_release_mnis_v3.8_wpb_38178 into release_mnis_v3.8
MR：http://10.2.3.111:86/backend_group/backend_application/mnis/merge_requests/7794

# 2.脚本  
  
>邮件  
  
> [!danger] 注意事项  
> 提供脚本为实际线上脚本，所以必须考虑实际线上情况  
> 1.开关，默认应为关闭（根据实际情况而定）  
> 2.IP地址，默认应为127.0.0.1（一般情况）  
  
---  
  
宝哥麻烦归档下脚本：  
  
测试环境：10.2.3.170  
项目：mnis
单号：38178  
版本号：MNIS V3.8.161
分支：fix_release_mnis_v3.8_wpb_38178
  
MySQL脚本  
  
```sql

```  
  
  
> [!danger] 注意事项  
> 脚本后不要带 `;` ~  
  
MongDB脚本  
  
```js  
use coms

var collection = db.sysConfigFile;
var targetKey = 'fmRecordConfig';
var childKey = 'fmRecordConfigAddEnable';

// 查找目标文档
var doc = collection.findOne({ 'key': targetKey });

if (doc) {
    // 检查 children 数组中是否已存在指定 key 的元素
    var exists = false;
    if (doc.children && doc.children.length > 0) {
        for (var i = 0; i < doc.children.length; i++) {
            if (doc.children[i].key === childKey) {
                exists = true;
                print('已存在 key 为 ' + childKey + ' 的元素，无需添加');
                break;
            }
        }
    }
    
    // 如果不存在，则添加新元素
    if (!exists) {
        collection.updateOne(
            { 'key': targetKey },
            {
                $push: {
                    'children': {
                        '_id': 'newlyGeneratedId',
                        'key': 'fmRecordConfigAddEnable',
                        'pattern': {
                            'componentType': 'Switch',
                            'label': '分娩记录单是否可添加'
                        },
                        'value': true
                    }
                },
                $currentDate: {
                    'updateTime': true
                }
            }
        );
        print('成功添加 key 为 ' + childKey + ' 的元素');
    }
} else {
    print('未找到 key 为 ' + targetKey + ' 的文档');
}
```  
  
# 3.提测单  
  
>提测群  

http://183.62.162.28:1024/zentao/testtask-view-10500.html#app=execution
38178【广西南宁第二人民医院】-移动护理-文书系统-旧版分娩记录单新增开关

# 4.其它
