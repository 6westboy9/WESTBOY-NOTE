## 1.CR

>Java群

项目：mnis  
内容：8440【肇庆正大国健康复医院】包药机对接
分支：feat_release_mnis_v3.8_wpb_8440 into qa_mnis_v3.8
MR：http://10.2.3.111:86/backend_group/backend_application/mnis/merge_requests/5484

# 2.脚本

>邮件

> [!danger] 注意事项
> 提供脚本为实际线上脚本，所以必须考虑实际线上情况
> 1.开关，默认应为关闭（根据实际情况而定）
> 2.IP地址，默认应为127.0.0.1（一般情况）
> 3.如果是修改原有配置，需要考虑平滑过度（不可简单覆盖）

---

宝哥麻烦归档下脚本：

测试环境：10.2.3.170
项目：mnis
服务：mnis
冲刺版本：移动护理迭代48
故事编号：8440
版本号：MNIS V3.8.108
分支：feat_release_mnis_v3.8_wpb_8440

MySQL脚本

```sql
--
```

> [!danger] 注意事项
> 脚本后不要带 `;` ~

MongDB脚本

```js
let config = db.sysConfigFile.findOne({ key: 'oralPackageThirdConfig' });

print("原始配置")
printjson(config);


let children = config.children;


// 更新名称
const newConfigs = [
    {
        "_id": "17218080284316",
        "key": "queryComponentName",
        "pattern": {
            "componentType": "Input",
            "label": "查询组件名称"
        }
    },
    {
        "_id": "17218012142154",
        "key": "baseUrl",
        "pattern": {
            "componentType": "Input",
            "label": "请求地址"
        },
        "value":"http://localhost:8080"
    },
    {
        "_id": "17218007665791",
        "key": "tokenRequestPath",
        "pattern": {
            "componentType": "Input",
            "label": "令牌请求路径"
        }
    },
    {
        "_id": "17218011231882",
        "key": "tokenRequestParam",
        "pattern": {
            "componentType": "Input",
            "label": "令牌请求参数"
        }
    },
    {
        "_id": "17218011645103",
        "key": "tokenResponseParseExpression",
        "pattern": {
            "componentType": "Input",
            "label": "令牌响应解析表达式"
        }
    },
    {
        "_id": "17218015573525",
        "key": "requestHeader",
        "pattern": {
            "componentType": "Input",
            "label": "条码请求头"
        }
    }];

let newConfigMap = new Map();
for (let newConfig of newConfigs) {
  newConfigMap.set(newConfig.key, newConfig);
}

// 更新原有名称
const updateChildren = [];
for (let item of children) {
    newConfigMap.delete(item.key);
    if (item.key === 'requestUrl') {
        item.pattern.label = '条码请求路径';
    } else if (item.key === 'requestParam') {
        item.pattern.label = '条码请求参数';
    } else if (item.key === 'responseFields') {
        item.pattern.label = '条码响应解析表达式';
    }
    updateChildren.push(item);
}

newConfigMap.forEach((value, key) => {
  updateChildren.push(value);
});


config.children = updateChildren;
print("最新配置")
printjson(config);

db.sysConfigFile.deleteOne({key:'oralPackageThirdConfig'});
db.sysConfigFile.insertOne(config);
```

# 3.提测单

>提测群

http://10.2.3.109:1024/zentao/testtask-view-8049.html
8440【肇庆正大国健康复医院】包药机对接 --- 已提测

# 4.其它
