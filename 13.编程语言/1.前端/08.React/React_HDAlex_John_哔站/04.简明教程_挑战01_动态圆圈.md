# React 简明教程 - 第四节：挑战 01 - 动态圆圈

本节通过一个**动态圆圈**的挑战练习，综合运用前面学过的知识：状态管理、受控组件、派生状态和条件渲染。

## 项目结构

```
lecture-04/start/
├── index.html    # HTML 入口文件
├── main.js       # React 组件逻辑（待完善）
└── style.css     # 样式文件
```

---

## 1. HTML 入口文件 (index.html)

```html
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- React 核心库 -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <!-- ReactDOM 库 -->
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <!-- Babel 转译器 -->
  <script type="text/javascript" src="https://unpkg.com/babel-standalone@6/babel.js"></script>
  <link rel="stylesheet" href="./style.css" />
  <title>Document</title>
</head>
<body>
<div id="app"></div>
<script type="text/babel" src="./main.js"></script>
</body>
</html>
```

---

## 2. 挑战起始代码 (main.js)

```javascript
/*
  需要实现的状态：
  - isPurple: boolean，控制圆圈是否为紫色
  - textColor: string，控制文字颜色
  - circleSize: number，控制圆圈大小
  - circleRotate: number，控制圆圈旋转角度
*/

function MyApp() {
  // 已完成：紫色开关状态
  const [isPurple, setIsPurple] = React.useState(false);

  // TODO: 添加其他状态...

  return (
    <main>
      <label>
        Purple
        <input
          type="checkbox"
          onChange={(event) => setIsPurple(event.target.checked)}
        />
      </label>

      <label>
        text color
        <select>
          <option value="" selected>White</option>
          <option value="text-black">Black</option>
          <option value="text-orange">Orange</option>
        </select>
      </label>

      <label>
        Circle Size
        <input type="number" value="150" />
      </label>

      <label>
        Circle Rotate
        <input type="number" value="0" />
      </label>

      <div className="circle">Hi!</div>
    </main>
  );
}

const appEl = document.querySelector("#app");
const root = ReactDOM.createRoot(appEl);
root.render(<MyApp/>);
```

---

## 3. 样式文件 (style.css)

```css
body {
  font-size: 20px;
  font-family: sans-serif;
}

label {
  margin-bottom: 20px;
  font-size: 20px;
  display: block;
}

select {
  font-size: 20px;
  margin-bottom: 20px;
}

input[type="number"] {
  display: block;
  font-size: 20px;
  margin-bottom: 20px;
}

.circle {
  width: 150px;
  height: 150px;
  border-radius: 100%;
  background-color: #45d619;
  text-align: center;
  color: #fff;
  line-height: 150px;
  font-size: 32px;
  font-weight: bold;
}

.purple {
  background-color: purple;
}

.text-black {
  color: #424242;
}

.text-orange {
  color: #ffc26f;
}
```

---

## 4. 挑战任务

### 任务清单

| # | 任务 | 涉及知识点 |
|---|---|---|
| 1 | 实现文字颜色选择器 | 受控组件 (select) |
| 2 | 实现圆圈大小控制 | 受控组件 (number) + 动态样式 |
| 3 | 实现圆圈旋转控制 | 受控组件 (number) + transform |
| 4 | 派生 purple 类名 | 派生状态 + 条件渲染 |

### 目标效果

- ✅ 勾选 "Purple" 复选框 → 圆圈变为紫色
- ✅ 选择文字颜色 → 圆圈内文字颜色变化
- ✅ 修改 "Circle Size" → 圆圈大小实时变化
- ✅ 修改 "Circle Rotate" → 圆圈旋转角度变化

---

## 5. 解题思路

### 5.1 文字颜色选择器

```javascript
// 添加状态
const [textColor, setTextColor] = React.useState("");

// 绑定 select
<select
  value={textColor}
  onChange={(event) => setTextColor(event.target.value)}
>
```

### 5.2 圆圈大小控制

```javascript
// 添加状态
const [circleSize, setCircleSize] = React.useState(150);

// 绑定 input
<input
  type="number"
  value={circleSize}
  onChange={(event) => setCircleSize(Number(event.target.value))}
/>

// 应用样式（需要同时修改 width、height、lineHeight）
<div
  className="circle"
  style={{
    width: circleSize,
    height: circleSize,
    lineHeight: circleSize
  }}
>
```

### 5.3 圆圈旋转控制

```javascript
// 添加状态
const [circleRotate, setCircleRotate] = React.useState(0);

// 绑定 input
<input
  type="number"
  value={circleRotate}
  onChange={(event) => setCircleRotate(Number(event.target.value))}
/>

// 应用 transform
<div
  className="circle"
  style={{ transform: `rotate(${circleRotate}deg)` }}
>
```

### 5.4 派生 purple 类名

```javascript
// 派生样式类名
const circleClass = isPurple ? "circle purple" : "circle";

// 应用类名
<div className={circleClass}>
```

或使用模板字符串：

```javascript
<div className={`circle ${isPurple ? "purple" : ""}`}>
```

---

## 6. 完整参考答案

```javascript
function MyApp() {
  const [isPurple, setIsPurple] = React.useState(false);
  const [textColor, setTextColor] = React.useState("");
  const [circleSize, setCircleSize] = React.useState(150);
  const [circleRotate, setCircleRotate] = React.useState(0);

  // 派生状态：组合所有样式类
  const circleClass = `circle ${isPurple ? "purple" : ""} ${textColor}`.trim();

  // 派生状态：组合内联样式
  const circleStyle = {
    width: circleSize,
    height: circleSize,
    lineHeight: `${circleSize}px`,
    transform: `rotate(${circleRotate}deg)`
  };

  return (
    <main>
      <label>
        Purple
        <input
          type="checkbox"
          onChange={(event) => setIsPurple(event.target.checked)}
        />
      </label>

      <label>
        text color
        <select
          value={textColor}
          onChange={(event) => setTextColor(event.target.value)}
        >
          <option value="">White</option>
          <option value="text-black">Black</option>
          <option value="text-orange">Orange</option>
        </select>
      </label>

      <label>
        Circle Size
        <input
          type="number"
          value={circleSize}
          onChange={(event) => setCircleSize(Number(event.target.value))}
        />
      </label>

      <label>
        Circle Rotate
        <input
          type="number"
          value={circleRotate}
          onChange={(event) => setCircleRotate(Number(event.target.value))}
        />
      </label>

      <div className={circleClass} style={circleStyle}>
        Hi!
      </div>
    </main>
  );
}

const appEl = document.querySelector("#app");
const root = ReactDOM.createRoot(appEl);
root.render(<MyApp/>);
```

---

## 7. 核心知识点总结

| 知识点 | 说明 | 示例 |
|---|---|---|
| **复选框受控** | `checked` + `onChange` | `checked={isPurple}` |
| **下拉框受控** | `value` + `onChange` | `value={textColor}` |
| **数字输入** | 需要转换为 Number | `Number(event.target.value)` |
| **动态类名** | 模板字符串拼接 | `` `circle ${textColor}` `` |
| **内联样式** | 对象语法，驼峰命名 | `{{ width: circleSize }}` |
| **派生状态** | 组合多个状态计算 | `circleClass`, `circleStyle` |

---

## 8. 小结

本节挑战综合运用了：

1. ✅ 多种受控组件（checkbox、select、number）
2. ✅ 派生状态的实际应用
3. ✅ 动态类名和内联样式
4. ✅ 类型转换（String → Number）
5. ✅ 模板字符串拼接

> **提示**：尝试自己完成挑战，遇到困难时再查看参考答案。
