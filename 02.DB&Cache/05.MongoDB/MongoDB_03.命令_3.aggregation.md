# 分组

## 简单分组

```js
// select inhosCode, count(*) from mnis.taskRemindRecord group by inhosCode order by count desc;
db.taskRemindRecord.aggregate([
    {
        "$match": {
            "inhosCode": { "$in": ["11482449", "11862451", "12035453", "12156472", "12260458", "12266458", "12295451", "12307472", "12313469", "12338450", "12351450", "12364465", "12365452", "12388450", "12388454", "12405457", "12405474", "12419450", "12421475", "12421477", "12422457", "12422464", "12432456", "12435452", "12436453", "12438458", "12442455", "12442458", "12443449", "12443549", "12443649", "12443740", "12443749", "12451448", "12453452", "12456456", "12457453", "12459455", "12467450", "12467458", "12467459", "12471460", "12475453", "12477449", "12485455", "12490463", "12492464", "12492465", "12492475", "12492501", "12492533", "12492563", "12492594", "12492595", "12500465", "12500467", "17151451", "42837172", "43017851", "498017851", "499017851", "74473691", "924594562"] },
            "planDate": { "$gte": ISODate("2024-10-08T00:00:00.000+08:00"), "$lte": ISODate("2024-10-08T23:59:59.000+08:00") },
            "ruleType": { "$in": ["vitalSign"] }
        }
    },
    { "$group": { "_id": "$inhosCode", "count": { "$sum": 1 } } },
    { "$sort": { "count": -1 } }
])
```

![[Pasted image 20241008142929.png|300]]

https://blog.csdn.net/wplblog/article/details/109594529

## 日期类型分组

>按照ISODate类型分组

```js
db.sysConfigFile.aggregate([
    {
        $match: {
            createTime: { $exists: true, $ne: null } // 过滤掉 createTime 为 null 或缺失的文档
        }
    },
    {
        $group: {
            _id: {
                year: { $year: "$createTime" },
                month: { $month: "$createTime" }
            },
            count: { $sum: 1 }
        }
    },
    {
        $sort: { "_id.year": -1, "_id.month": -1 }
    }
])
```

![[Pasted image 20250430173414.png]]

# 去重

![[MongoDB_03.命令_4.distinct#存在问题]]